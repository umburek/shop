<h2>Products</h2>

<%= form_for @product, as: :product, url: admin_products_path do |f| %>

  <div class="field form-group">
    <%= f.text_field :name, class: "form-control", placeholder: "Name" %>
    <%= f.text_area :description, size: "70x5", class: "form-control", placeholder: "Description" %>
    <%= f.number_field :on_stock, class: "form-control" %>
    <%= f.file_field :photo, class: "form-control" %>
    <%= f.select :category_ids, Category.all.order(:name).map { |i| ["#{i.name}", i.id] } %>

    <%= f.fields_for :category_products do |category_subform| %>
      <%= category_subform.select :category_id, Category.all.order(:name).map { |i| ["#{i.name}", i.id] } %>
      <%= category_subform.collection_select(:category, :id, Category.all, :id, :name) %>
    <% end %>
  </div>

  <%#= collection_select(:category, :id, Category.all, :id, :name) %>

  <div class="actions">
    <%= f.submit "Create Product", class: 'btn btn-secondary' %>
  </div>
<% end %>

<br>
<% @products.each do |product| %>
  <% if product.photo.attached? %>
    <%= image_tag product.photo, width: "200px" %>
  <% end %>
  <br>
  <strong>Name:</strong>
  <%= product.name %>
  <br>
  <strong>Description:</strong>
  <%= product.description %>
  <br>
  <strong>on Stock:</strong>
  <%= product.on_stock %>
  <br>
  <strong>Category:</strong>
  <% product.category_products.each do |category_product| %>
    <%= category_product.category.name %>
  <% end %>
  <br>
  <%= link_to 'Edit', edit_admin_product_path(product), class: "btn btn-secondary" %>
  <%= link_to 'Delete', product, method: :delete, class: "btn btn-secondary" %>
  <br>
  <br>
<% end %>